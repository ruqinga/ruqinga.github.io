<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>R on Ruqing a</title><link>https://ruqinga.github.io/tags/r/</link><description>Recent content in R on Ruqing a</description><generator>Hugo</generator><language>en</language><copyright>&amp;copy; 2021 &lt;a href="https://www.wangchucheng.com/">WANG Chucheng&lt;/a> and &lt;a href="https://www.ruiqima.com/">MA Ruiqi&lt;/a></copyright><lastBuildDate>Tue, 14 Jan 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://ruqinga.github.io/tags/r/index.xml" rel="self" type="application/rss+xml"/><item><title>Motif analysis by meme and visualize in R</title><link>https://ruqinga.github.io/posts/motif-analysis-by-meme-and-visualize-in-r/</link><pubDate>Tue, 14 Jan 2025 00:00:00 +0000</pubDate><guid>https://ruqinga.github.io/posts/motif-analysis-by-meme-and-visualize-in-r/</guid><description>&lt;h2 id="1-prepare-data">1. prepare data&lt;/h2>
&lt;pre>&lt;code class="language-r">library(readxl) # read_xlsx
library(dplyr) # process data

data &amp;lt;- read_xlsx(&amp;quot;input/Differentially_annot .xlsx&amp;quot;, sheet = 1)

# extract seq
df &amp;lt;- data %&amp;gt;%
 mutate(`Modified sequence` = `Modified sequence` %&amp;gt;%
 gsub(&amp;quot;^_&amp;quot;, &amp;quot;&amp;quot;, .) %&amp;gt;% # 去除首部的 _
 gsub(&amp;quot;_$&amp;quot;, &amp;quot;&amp;quot;, .) %&amp;gt;% # 去除尾部的 _
 gsub(&amp;quot;\\[.*?\\]&amp;quot;, &amp;quot;&amp;quot;, .)) %&amp;gt;% # 去除 [] 及其内容
 filter(nchar(`Modified sequence`) &amp;gt;= 8) # meme 需要输入序列长度大于8

# Add data filtering


&lt;/code>&lt;/pre>
&lt;p>&lt;img src="https://raw.githubusercontent.com/ruqinga/picture/main/2024/IMG-20250907093740685.png">&lt;/p>
&lt;p>save as fasta&lt;/p>
&lt;pre>&lt;code class="language-sh"># save as fasta
writeLines(paste0(&amp;quot;&amp;gt;seq&amp;quot;, 1:length(df$`Modified sequence`),&amp;quot;_&amp;quot;, df$`Protein accession`, &amp;quot;\n&amp;quot;, df$`Modified sequence`),
 &amp;quot;modified_sequence_v1.fasta&amp;quot;)
&lt;/code>&lt;/pre>
&lt;p>&lt;img src="https://raw.githubusercontent.com/ruqinga/picture/main/2024/IMG-20250907093740625.png">&lt;/p></description></item></channel></rss>